Καλησπέρα σε όλους τους καργίολιδες και καργιόλες τριγύρω,

Slide 1 (εισαγωγή)
Το αντικείμενο της παρούσας διπλωματικής ήταν ο εντοπισμός μη τενικών απωλειών με τη αλγορίθμους και συστήματα μηχανικής μάθησης.

Slide 2 (Δελτίο τύπου ΔΕΗ)
(Διόρθωση: το δελτίο τύπου είναι του 2017 όχι του 2016)
Το κίνητρο αυτής της διπλωματικής ήταν τα αυξανόμενα κρούσματα ρευματοκλοπών που σύμφωνα με τη ΡΑΕ το 2016 έφτασαν το 3,2% επί της συνολικά εγχεόμενης ενέργειας στο δίκτυο της ηπειρωτικής και νησιότικης χώρας.
Σύμφωνα με τη ΡΑΕ τα έσοδα που διαφεύγουν κάθε χρόνο λόγω ρευματοκλοπών με βάση τις μοναδιαίες τιμές του 2016 ανέρχονται στα 210 εκατ. ευρώ για τη ΔΕΗ και τις θυγατρικές της.
Γενικότερα υπάρχουν διάφοροι τρόποι που μπορεί κάποιος να εξαπατήσει τον πάροχο ενέργειας. Σε παρόχους με μειωμένη διαφάνεια συχνά γίνονται άτυπες συννενοήσεις υπαλλήλων με εργαζομένους για μείωση του λογαρισμού των πρώτων, ενώ σε αναπτυσσόμενες χώρες παρατηρείται έντονα το φαινόμενο της μη πλήρωσης των λογαριασμών με συνέπεια. Στην Ελλάδα τα πιο συχνά κρουσματα ρευματοκλοπών είναι η απευθείας σύνδεση φορτίων στις εκτεθειμένες γραμμές της ΔΕΗ και η επέμβαση στη μετρητική διάταξη για την επίτευξη χαμηλότερρων χρεώσεων. 
Η διπλωματική αυτή θα καλύψει το τελευταίο τύπο μη τεχνικών απωλειών.

Slide 3 (Διαδικασία data mining)
Η ευρεία εφαρμογή των έξυπνων μετρητών είναι μια πραγματικότητα που πλησιάζει ολοένα και κοντύτερα. Η συχνότητα λήψης μετρήσεων χάρις αυτούς παρέχει τη δυνατότητα εφαρμογής τεχνικών εξόρυξης, προσομοίωσης και ταξινόμησης δεδομένων.

Slide 4 (Προεπεξεργασία)
Κατά την προεπεξεργασία των δεδομένων γίνονται όλες οι απαραίτητες ενέργειες ώστε τα αρχικά ακατέργαστα δεδομένα να δομηθούν με τέτοιο τρόπο ώστε να γίνονται κατανοητά από αυτούς που τα χειρίζονται και να απομακρυνθούν οι περιττές και ασσαφείς πληροφορίες ή μετρήσεις.
Το σετ δεδομένων για το μεγαλύτερο μέρος των δοκιμών απαρτίστηκε από 4.500 καταναλωτές με μετρήσεις ενός έτους με συχνότητα που επιλεγόταν αναλογα τη δοκιμή σε ημίωρα, ώρες, μέρες, μήνες κτλ.

Slide 5 (Προσομοίωση απάτης)
Καθώς τα δεδομένα προέρχονταν από ειλικρινείς πελάτες, χρειάστηκε η προσομοίωση των ρευματοκλοπών. Προσομοιάστηκαν 3 διαφορετικοί τύποι απάτης προσθέτοντας μεγαλύτερο τυχαίο παράγοντα σε κάθε περίπτωση. Στην πρώτη περίπτωση η ένταση της κλοπής μένει σταθερή σε όλο το έτος
στην δεύτερη μένει σταθερή ανά ημέρα, ενώ στην τρίτη ανά ώρα. Μια ακόμη διαφορά που παρατηρείται μεταξύ των διαφορετικών τύπων είναι ότι μόνο η πρώτου τύπου είναι συνεχόμενη μέσα στο χρόνο, ενώ οι άλλες δύο είναι διακοπτόμενες ανά τυχαίες μέρες και ώρες.

Slide 6 (Επιλογή απάτης)
Δυστυχώς οι διακοπτόμενες απάτες τύπου 2 και 3 ήταν εξαιρετικά δύσκολο να διαχωριστούν από τις ήδη περίπλοκες χρονοσειρές κατανάλωσης. Γι αυτό το λόγο οι δοκιμές επικεντρώθηκαν στην εύρεση απάτης τύπου 1. Ειδικότερα, η απάτη τύπου 1 παίρνει από  μια τυχαία κατανομή την ημέρα που 
ξεκινά ο καταναλωτής να επεμβαίνει στις μετρήσεις του και την ένταση της κλοπής από μια κατανομή Βήτα για να προσομοιωθεί πιο επιθετική απάτη. Οι καταναλωτές που επιλόγονται είναι της τάξης του 10% στις σύνθετες δοκιμές και αυτό επιτυγχάνεται με τυχαίο τρόπο.

Slide 7 (Machine learning)
Για την επίτευξη της ταξινόμησης των καταναλωτών χρησιμοποιήθηκαν τρεις διαφορετικές προσεγγίσεις. Η πρώτη προσέγγιση με επιβλεπόμενους αλγορίθμους είναι η πιο δημοφιλής, αλλά και η λιγότερο εφαρμόσιμη σε πραγματικά προβλήματα, καθώς απαιτεί εκπαίδευση με ήδη γνωστά αποτελέσματα που
σπανίζουν στην πραγματική ζωή σε τέτοια προβλήματα. Η προσέγγιση της μη επιβλεπόμενεης μάθησης είναι άμεσα εφαρμόσιμη σε καθημερινά προβλήματα, καθώς δεν απαιτεί καμιά γνώση των δεδομένων και για αυτό συνήθως χρησιμοποιούνται 
σύνθετοι στατιστικοί κανόνες για την ταξινόμηση. Η τελευταία προσέγγιση είναι η μέση λύση ανάμεσα στην επιβλεπόμενη και μη επιβλεπόμενη μάθηση. Η ημι-επιβλεπόμενη μάθηση δεν απαιτεί εκπαίδευση, αλλά απαιτεί γνώση λίγων αποτελεσμάτων για να βελτιστοποιήσει τον ταξινομητή της.

Slide 8 (Μετρικές)
Slide 9 (Επιβλεπόμενος αλγόριθμος)
Για τη δοκιμή της επιβλεπόμενης μάθησης χρησιμοποιήθηκαν 2 βιβλιοθήκες η LIBSVM που περιέχει ταξινομητές SVΜ και η LIBLINEAR που περιέχει δημοφιλείς γραμμικούς ταξινομητές για δεδομένα μεγάλης κλίμακας. Την καλύτερη επίδοση την είχε το πακέτο LIBSVM ταξινομώντας χρονοσειρές 1 έτους
με γραμμικό SVM. Παράλληλα, το ίδιο πατέκο δοκιμάστηκε και στους άλλους τύπους απάτης με αποτελέσματα που υποδεικνύουν πως η ταξινόμηση με τόσο μεγάλο βαθμό τυχαιότητας είναι εξαιρετικά δύσκολη.

Slide 10 (Χαρακτηριστικά)
Για να μπορέσει να αντιμετωπιστεί το πρόβλημα της ταξινόμησης από νέα συστήματα απαιτείται η εξαγωγή χαρακτηριστικών των χρονοσειρών. Διαχωρίζοντας τα χαρακτηριστικά σε γενικά και εξειδικευμένα τα πρώτα παρέχουν τυπικές πληροφορίες για τη χρονοσειρά, ενώ τα δεύτερα προσπαθούν 
να εντοπίσουν την απάτη. Τα εξειδικευμένα χαρακτηριστικά λειτουργούν ποσοστιαία συγκρίνοντας δύο κομμάτια καταναλώσεων. Στον κινούμενο μέσο όρο μηνιαίου μέσου όρου λαμβάνεται η μέγιστη ποσοστιαία διαφορά κατανάλωσης σκανάροντας όλη τη χρονοσειρά.
Στη συμμετρική διαφορά καταναλώσεων εντοπίζεται η ημέρα ελάχιστης κατανάλωσης και συγκρίνονται τα δύο συμμετρικά κομμάτια με άξονα συμμετρίας αυτή τη μέρα.
Η τμηματική διαφορά κατανάλωσης με ομοίου επιτυγχάνεται συσταδοποιώντας τους καταναλωτές και δημιουργώντας για κάθε συστάδα ένα μέσο όρο κατανάλωσης. Για κάθε καταναλωτή συγκρίνεται η κατανάλωση του με την μέση κατανάλωση της συστάδας μετά το σημείο ελαχίστου.
 Αν η ποσοστιαία διαφορά είναι μεγάλη τότε κρατάμε την τιμή, αν όχι τοποθετείται μηδεν.
Δοκιμάζοντας τα χαρακτηριστικά με 50% καταναλωτών με μη τεχνικές απώλειες και μεγάλες εντάσεις έχουμε την παρούσα απόδοση του κάθε εξειδικευμένου χαρακτηριστικού.

Slide 11 (Συστατικά μη επιβλεπόμενου)
Εδώ μπορεί να παρατηρηθεί η δομή του μη επιβλεπόμενου συστήματος. Τα δεδομένα επεξεργάζονται για να είναι σε πρακτική μορφή για τους αλγορίθμους στην προεπεξεργασία δεδομένων και στη συνέχεια γίνεται προσομοίωση μη τεχνικών απωλειών σε 10% του πληθυσμού.
Το σύστημα έχει δύο βασικούς άξονες που συνεργάζονται για την αξιόπιστη εξαγωγή αποτελεσμάτων. Στον ένα άξονα κανονικοποιούνται οι χρονοσειρές ανά καταναλωτή σε εύρος [-1,1] και συσταδοποιούνται σε 2 συστάδες που εκφράζουν τον κύριο πληθυσμό και τον 
υπόλοιπο που περιλεμβάνει ιδιόμορφες καταναλώσεις. Για να βελτιωθεί η ταξινόμηση χρησιμοποιείται ο δεύτερος άξονας που περιλαμβάνει την εξαγωγή των χαρακτηριστικών και απενοχοποιεί καταναλωτές από τη συστάδα με τις ιδιόμορφες καταναλώσεις στην περίπτωση που
έχει λιγότερα από 3 εξειδικευμένα χαρακτηριστικά.

Slide 12 (Αποτελέσματα)
Δοκιμάζοντας 4.500 καταναλωτές με 10% ποσοστό απάτης με κυμαινόνεμη ένταση παρατηρούνται οι καμπύλες DR και το FPR ως προς την ένταση. Γρήγορα καθίσταται σαφές πως ο αλγόριθμος δεν είναι ιδιαίτερα αξιόπιστος σε επιθέσεις χαμηλής έντασης.
Ειδικότερα τα DR και FPR έχουν έντονες διακυμάνσεις μέχρι η ένταση να φτάσει το 0.5, μετά από αυτό το σημείο το σύστημα γίνεται αρκετά ικανό στην εντοπισμό της απάτης με DR>82% και FPR<6%.

Slide 13 (Συστατικά ημι-επιβλεπόμενου)
Το σχεδιάγραμμα αυτό περιγράφει τα συστατικά και τη δομή του αλγορίθμου ημι-επιβλεπόμενης μάθησης. Όπως και στον μη επιβλεπόμενο αλγόριθμο, έτσι και εδώ χρησιμοποιήθηκαν 2 άξονες για την εξαγωγή χαρακτηριστικών.
Ο πρώτος είναι ίδιος με αυτό του μη επιβλεπόμενου συτήματος, κανονικοποιώντας και συσταδοποιώντας τις χρονοσειρές. Ο δεύτερος εκτός από την εξαγωγή χαρακτηριστικών και την εφαρμογή κανόνα των τριων χαρακτηριστικών, μειώνει τις 
8 διαστάσεις των χαρακτηριστικών σε 2 με χρήση PCA, κανονικοποιεί τα χαρακτηριστικά σε εύρος [0,1] και εφαρμόζει τον αλγόριθμο ανίχνευσης ανωμαλιών με πολυμεταβλητή γκαουσιανή κατανομή. Τα αποτελέσματα της ταξινομησης των δύο αξόνων είναι δυαδικά
άρα χρησιμοποιούνται λογικές πράξεις για την τελική ταξινόμηση. Η χρήση της πύλης AND ήταν η πιο αξιόπιστη, καθώς κρατά σε χαμηλά επίπεδα τις λάθος προβλέψεις.

Slide 14 (PCA)
Η μείωση διάστασης παρέχει τη δυνατότητα να οπτικοποιηθούν τα δεδομένα σε δύο διαστάσεις. Στο γράφιμα φαίνονται με κίτρινούς οι αρνητική κλάση, ενώ με μαύρο η θετική κλάση, καθιστώντας σαφές πως η θετική κλάση διαχωρίζεται σε μεγάλο βαθμό από 
τον κύριο πληθυσμό. Αυτό το γεγονός μπορεί να αποδειχθεί και απο τα αποτελέσματα που βελτιώνονται σε γενικό βαθμό με τη χρήση 2 διαστάσεων.
Οι αρνητική κλάση έχει κέντρο τον 0,0 και επεκτείνεται πάνω αριστερά για καταναλωτές με μεγάλες ενεργειακές ανάγκες. Στο κάτω μέρος φαίνεται η θετική κλάση μαζί με λίγους καταναλωτές που 
έχουν χαμηλές και ιδιόμορφες καταναλώσεις.

Slide 15 (Anomaly Detection)
Συνδιάζοντας τη μείωση διάστασης και την ανίχνευση ανωμαλιών καθίσταται δυνατή η απεικόνιση των ισοϋψών της πολυμεταβλητής γκαουσιανής κατανομής.
Το μοντέλο της κατανομής χτίζεται και δοκιμάζεται με 70% των δεδομένων, ενώ το υπόλοιπο 30% χρησιμοποιείται για βελτιστοποίηση του ταξινομητή βάσει του βέλτισου 
F1 score. Το σχήμα των ισοϋψων είναι ένας πλατύς κύκλος έτσι ώστε να συμπεριλαμβάνει κάποιες μικρομεσσαίες επιχειρήσεις και μερικούς καταναλωτές με 
χαμηλούς λογαριασμούς

Slide 16 (Αποτελέσματα)
Σε αυτό το σημείο έγινε δοκιμή έντασης απάτης του συστήματος ανίχνευσης ανωμαλιών και παρατηρήθηκε πως η απόδοση βελτιώθηκε αισθητά από το μη-επιβλεπόμενο αλγόριθμο.
Και οι δύο καμπύλες έχουν ομαλή πορεία και μάλιστα αύξουσα στο DR και φθίνουσα στο FPR. Ειδικότερα, ο ταξινομητής έχει χαμηλά ποσοστό λάθος προβλέψεων που όσο η ενταση της
απάτης αυξάνεται αυτο μειώνεται ως και κάτω από 1%. Στο DR παρατηρείται πως δεν φτάνει σε εξαιρετικά υψηλά επίπεδα, αλλά με τόσο χαμηλά ποσοστά FPR
δεν είναι ανησυχιτικό δείγμα.

Slide 17 (Συγκριση)
Συνοψίζοντας, με το γράφημα μπορούμε να συγκρίνουμε την γενικότερη επίδοση των συστημάτων παρατηρώντας τις μετρικές Accuracy, F1 score και BDR.
Όπως αναμενόταν το επιβλεπόμενο σύστημα έχει τα καλύτερα αποτελέσματα, με εξαιρετικά μικρό ποσοστό λάθους. Το ημι-επιβλεπόμενο σύστημα με την ανίχνευση ανωμαλιών έρχεται αρκετά κοντά
στο επιβλεπόμενο σύστημα χρησιμοποιώντας λιγότερο από τα μισά αποτελέσματα για εκπαίδευση. Ενώ το μη -επιβλεπόμενο σύστημα με τους κανόνες είναι το 
λιγότερο εύστοχο αλλά το πιο εφαρμόσιμο. Καθίσταται, λοιπόν, σαφές πως η ανίχνευση μη τεχνικών απώλειων με μηχανική μάθηση είναι εφικτή με διάφορα 
συστήματα και αλγορίθμους.


